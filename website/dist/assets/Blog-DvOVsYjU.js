import{A as S,r as l,j as e,B as v}from"./index-P9AEKrjw.js";import{S as T}from"./search-DO5pF8ph.js";import{C as B}from"./calendar-BULXiScO.js";import{c as D}from"./createLucideIcon-CHvZU8O2.js";/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],R=D("arrow-right",A),b={baseURL:S,async getAllBlogs(){const i=await fetch(`${this.baseURL}/blog`);if(!i.ok)throw new Error("Failed to fetch blogs");return i.json()},async getBlog(i){const s=await fetch(`${this.baseURL}/blog/${i}`);if(!s.ok)throw new Error("Failed to fetch blog");return s.json()},async createBlog(i){const s=new FormData;s.append("heading",i.heading),s.append("content",i.content),i.image&&s.append("image",i.image);const o=await fetch(`${this.baseURL}/blog`,{method:"POST",body:s});if(!o.ok)throw new Error("Failed to create blog");return o.json()},async updateBlog(i,s){const o=new FormData;s.heading&&o.append("heading",s.heading),s.content&&o.append("content",s.content),s.image&&o.append("image",s.image);const u=await fetch(`${this.baseURL}/blog/${i}`,{method:"PUT",body:o});if(!u.ok)throw new Error("Failed to update blog");return u.json()},async deleteBlog(i){if(!(await fetch(`${this.baseURL}/blog/${i}`,{method:"DELETE"})).ok)throw new Error("Failed to delete blog")}},P=({onSelectBlog:i})=>{const[s,o]=l.useState([]),[u,h]=l.useState(!0),[m,g]=l.useState(""),[c,d]=l.useState([]);l.useEffect(()=>{y()},[]),l.useEffect(()=>{if(m){const r=s.filter(x=>x.heading.toLowerCase().includes(m.toLowerCase())||x.content&&x.content.toLowerCase().includes(m.toLowerCase()));d(r)}else d(s)},[m,s]);const y=async()=>{try{h(!0);const r=await b.getAllBlogs();o(r),console.log("Blogs Data:"),console.log(r),d(r)}catch(r){console.error("Error loading blogs:",r)}finally{h(!1)}},j=(r,x=200)=>{if(!r)return"";const n=document.createElement("div");n.innerHTML=r;let p=n.textContent||n.innerText||"";return p=p.replace(/\s+/g," ").trim(),p.length>x?p.substring(0,x)+"...":p},f=r=>new Date(r).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"});return u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"The refurbed Blog"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Discover stories, background information and expert knowledge about refurbed and sustainable shopping."}),e.jsxs("div",{className:"mt-8 max-w-md mx-auto relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search articles...",value:m,onChange:r=>g(r.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-12",children:c.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No blog posts found."})}):e.jsx("div",{className:"grid gap-8 md:grid-cols-2 lg:grid-cols-3",children:c.map(r=>e.jsxs("article",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden",children:[r.image&&e.jsx("div",{className:"aspect-video bg-gray-200",children:e.jsx("img",{src:`${v}/storage/${r.image}`,alt:r.heading,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3 line-clamp-2",children:r.heading}),e.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3",children:j(r.content)}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),f(r.created_at||new Date)]})})}),e.jsxs("button",{onClick:()=>i(r.id),className:"inline-flex items-center text-purple-600 hover:text-purple-800 font-medium transition-colors duration-200",children:["READ MORE",e.jsx(R,{className:"w-4 h-4 ml-1"})]})]})]},r.id))})})]})},F=({blogId:i,onBack:s})=>{const[o,u]=l.useState(null),[h,m]=l.useState(!0);l.useEffect(()=>{g()},[i]);const g=async()=>{try{m(!0);const d=await b.getBlog(i);u(d)}catch(d){console.error("Error loading blog:",d)}finally{m(!1)}},c=d=>new Date(d).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"});return h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):o?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:e.jsx("button",{onClick:s,className:"text-purple-600 hover:text-purple-800 font-medium",children:"← Back to Blog"})})}),e.jsx("article",{className:"max-w-4xl mx-auto px-4 py-12",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[o.image&&e.jsx("div",{className:"aspect-video bg-gray-200 overflow-hidden",children:e.jsx("img",{src:`${v}/storage/${o.image}`,alt:o.heading,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:o.heading}),e.jsx("div",{className:"flex items-center text-gray-600 text-sm",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),c(o.created_at||new Date)]})})]}),e.jsx("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:o.content}})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Blog post not found"}),e.jsx("button",{onClick:s,className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Back to Blog"})]})})},H=({onBack:i})=>{const[s,o]=l.useState([]),[u,h]=l.useState(null),[m,g]=l.useState(!1),[c,d]=l.useState({heading:"",content:"",image:null}),[y,j]=l.useState(!1),[f,r]=l.useState(!1),x=l.useRef(null),n=l.useRef(null);l.useEffect(()=>{if(window.Quill){r(!0);return}const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.snow.min.css",document.head.appendChild(t);const a=document.createElement("script");return a.src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.min.js",a.onload=()=>{r(!0)},document.head.appendChild(a),()=>{document.head.contains(t)&&document.head.removeChild(t),document.head.contains(a)&&document.head.removeChild(a)}},[]),l.useEffect(()=>{if(f&&m&&x.current&&!n.current){x.current.innerHTML="";const t=[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{align:[]}],["link","image"],["blockquote","code-block"],["clean"]];try{n.current=new window.Quill(x.current,{theme:"snow",placeholder:"Write your blog content here...",modules:{toolbar:t}}),c.content&&n.current.clipboard.dangerouslyPasteHTML(c.content),n.current.on("text-change",()=>{const a=n.current.root.innerHTML;d(N=>({...N,content:a}))}),setTimeout(()=>{if(n.current){const a=n.current.root;a&&(a.setAttribute("contenteditable","true"),a.style.minHeight="300px",a.style.cursor="text",a.addEventListener("click",N=>{n.current&&n.current.focus()}))}},200)}catch(a){console.error("Error initializing Quill editor:",a)}}return()=>{if(!m&&n.current)try{n.current.off("text-change"),n.current=null}catch(t){console.error("Error cleaning up editor:",t)}}},[f,m]),l.useEffect(()=>{n.current&&u&&c.content&&m&&setTimeout(()=>{n.current&&n.current.clipboard.dangerouslyPasteHTML(c.content)},100)},[u,m]),l.useEffect(()=>{p()},[]);const p=async()=>{try{const t=await b.getAllBlogs();o(t)}catch(t){console.error("Error loading blogs:",t)}},k=async()=>{if(!c.heading||!c.content){alert("Please fill in all required fields");return}j(!0);try{const t=n.current?n.current.root.innerHTML:c.content,a={...c,content:t};u?await b.updateBlog(u.id,a):await b.createBlog(a),w(),p()}catch(t){console.error("Error saving blog:",t)}finally{j(!1)}},E=t=>{h(t),d({heading:t.heading,content:t.content,image:null}),g(!0)},C=async t=>{if(window.confirm("Are you sure you want to delete this blog post?"))try{await b.deleteBlog(t),p()}catch(a){console.error("Error deleting blog:",a)}},w=()=>{if(n.current)try{n.current.off("text-change"),n.current=null}catch(t){console.error("Error cleaning up editor:",t)}g(!1),h(null),d({heading:"",content:"",image:null})},L=t=>{if(!t)return"";const a=document.createElement("DIV");return a.innerHTML=t,a.textContent||a.innerText||""};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("button",{onClick:i,className:"text-purple-600 hover:text-purple-800 mb-2",children:"← Back to Blog"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Blog Administration"})]}),e.jsx("button",{onClick:()=>{h(null),d({heading:"",content:"",image:null}),g(!0)},className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Create New Post"})]}),m&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:u?"Edit Blog Post":"Create New Blog Post"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:c.heading,onChange:t=>d({...c,heading:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content"}),f?e.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden bg-white",style:{minHeight:"350px"},children:e.jsx("div",{ref:x,style:{minHeight:"300px",backgroundColor:"white",cursor:"text"}})}):e.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:e.jsx("p",{className:"text-gray-500",children:"Loading rich text editor..."})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>d({...c,image:t.target.files[0]}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:k,disabled:y||!f,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:y?"Saving...":u?"Update Post":"Create Post"}),e.jsx("button",{type:"button",onClick:w,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Content Preview"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.heading})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:L(t.content||"")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at||new Date).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>E(t),className:"text-purple-600 hover:text-purple-900",children:"Edit"}),e.jsx("button",{onClick:()=>C(t.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},t.id))})]})})})]})})},q=({CurrentView:i="list"})=>{const[s,o]=l.useState(i),[u,h]=l.useState(null),m=d=>{h(d),o("post")},g=()=>{o("list"),h(null)},c=()=>{o("admin")};return e.jsxs("div",{className:"min-h-screen",children:[s==="list"&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm",children:"Admin Panel"})}),s==="list"&&e.jsx(P,{onSelectBlog:m}),s==="post"&&u&&e.jsx(F,{blogId:u,onBack:g}),s==="admin"&&e.jsx(H,{onBack:g})]})};export{q as default};
